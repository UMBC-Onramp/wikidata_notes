Here is a sparql query to get data on malware instances

```
# find all Wikidata malware entities and their English
#  label, description, aliases, and antiVirusAliases
select ?mid 
       ?name 
       ?desc
       (group_concat(DISTINCT ?alias; separator=" | ") as ?aliases) 
       (group_concat(DISTINCT ?ava;separator=" | ") as ?antiVirusAliases)
{
  ?mid wdt:P31/wdt:P279* wd:Q14001.
  OPTIONAL {?mid rdfs:label ?name FILTER(lang(?name)='en')}
  OPTIONAL {?mid schema:description ?desc FILTER(lang(?desc)='en')}
  OPTIONAL {?mid skos:altLabel ?alias FILTER(lang(?alias)='en')}
  OPTIONAL {?mid wdt:P1845 ?ava.}   # antiVirusLabel used by vendor
}
GROUP BY ?mid ?name ?desc
```

Here is a shortened query url if you want to see the results on the Wikidata query service cite: [https://w.wiki/43dX](https://w.wiki/43dX).  I also downloaded these from the site to this repository as a JSON file [malware_example.json](https://raw.githubusercontent.com/UMBC-Onramp/wikidata_notes/main/malware_query.json) and a TSV file [malware_query.tsv](https://raw.githubusercontent.com/UMBC-Onramp/wikidata_notes/main/malware_query.tsv)

The query returns 253 results. The query also groups the aliases and antiVirusALiases so that in the end, there is just one result (i.e., row) for each malware instance.  
The value for the aliases and antiVirusAliases will be a string will all of the ones found separated by 'space|space'. If we use the group_concat in this way, we also have to specify a GROUP BY clause at the end of the query to identify the other elements.

Virtually all (but not all) wikidata items will have a rdfs:label property, but many will not have a description of any alaiases.
So, we have to wrap query elements for these in an OPTIONAL so that the query would not fail for Malware items that do not have all of them.

--
--
Here is another example that shows how many properties does each of the 240 malware instance in Wikidata have.  It shows that that most have very few properties.

```
# How many properties does each malware instance have?
select distinct ?mid ?mname (count(?pid) as ?numProps)  {
  ?mid wdt:P31/wdt:P279* wd:Q14001.
  ?mid rdfs:label ?mname FILTER(lang(?mname)='en').
  ?mid ?prop ?any.
  ?pid wikibase:directClaim ?prop.
  #?pid rdfs:label ?pname FILTER(lang(?pname)='en').
  }
GROUP BY ?mid ?mname
Order by DESC(?numProps)
```
Run the query to see the results by clicking on this [link](https://w.wiki/43gM)

--
--
A third example shows the number of malware instances holding each property held by some instance.

```
# find the number of malware instances that have each property?
select distinct ?pid ?pname (count(?mid) as ?numMids)  {
  ?mid wdt:P31/wdt:P279* wd:Q14001.
  #?mid rdfs:label ?mname FILTER(lang(?mname)='en').
  ?mid ?prop ?any.
  ?pid wikibase:directClaim ?prop.
  ?pid rdfs:label ?pname FILTER(lang(?pname)='en').
  }
GROUP BY ?pid ?pname
Order by DESC(?numMids)
```
Run the query and see the [results](https://w.wiki/43gN)
